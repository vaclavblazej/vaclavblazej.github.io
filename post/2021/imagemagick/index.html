<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>
        
            Imagemagick examples - Homepage of Vašek
        
    </title>
    <meta name="description" content="Homepage of Vašek">
    <meta name="author" content="Václav Blažej">

    
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <link href="https://vaclavblazej.github.io//font/fonts.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://vaclavblazej.github.io/css/fonts.css">

    
    <script src="https://vaclavblazej.github.io/js/custom.js"></script>
    <link rel="stylesheet" href="https://vaclavblazej.github.io/css/custom.css">

    <link rel="shortcut icon" href="https://vaclavblazej.github.io//favicon.ico" />

    

    
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [ ['$','$'] ],
                displayMath: [ ["\\[","\\]"] ],
                processEscapes: true,
                autoload: {
                    color: [],
                    colorv2: ['color']
                },
                packages: {'[+]': ['noerrors']}
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process',
                renderActions: {
                    addMenu: [0, '', '']
                }
            },
            loader: {
                load: ['[tex]/noerrors']
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>

    <script src="https://vaclavblazej.github.io/js/jquery.min.js" type="text/javascript"></script>

</head>
<body>

<div class="header noprint">
    
    <div class="desktop nav-menu">
        <a href="https://vaclavblazej.github.io/" class="site-title pad">Homepage of Vašek</a>
        <ul>
            
            <li class="pad-vertically">
                <a class="pad" href="https://vaclavblazej.github.io/">Material</a>
            </li>
            
            <li class="pad-vertically">
                <a class="pad" href="https://vaclavblazej.github.io/post/">Blog</a>
            </li>
            
            <li class="pad-vertically">
                <a class="pad" href="https://vaclavblazej.github.io/teaching/">Teaching</a>
            </li>
            
            <li class="pad-vertically">
                <a class="pad" href="https://vaclavblazej.github.io/pub/">Research</a>
            </li>
            
            <li class="pad-vertically">
                <a class="pad" href="https://vaclavblazej.github.io/about/">About</a>
            </li>
            
        </ul>
    </div>
    <div class="mobile nav-menu">
        <a href="https://vaclavblazej.github.io/" class="site-title pad">Homepage of Vašek</a>
        <a href="#" id="toggle-btn">&#9776;</a>
    </div>
    <div>
        <ul id="toggle-content" style="display:none;">
            
            <li class="pad-vertically">
                <a class="pad" href="https://vaclavblazej.github.io/">Material</a>
            </li>
            
            <li class="pad-vertically">
                <a class="pad" href="https://vaclavblazej.github.io/post/">Blog</a>
            </li>
            
            <li class="pad-vertically">
                <a class="pad" href="https://vaclavblazej.github.io/teaching/">Teaching</a>
            </li>
            
            <li class="pad-vertically">
                <a class="pad" href="https://vaclavblazej.github.io/pub/">Research</a>
            </li>
            
            <li class="pad-vertically">
                <a class="pad" href="https://vaclavblazej.github.io/about/">About</a>
            </li>
            
        </ul>
    </div>
</div>



<div class="content">
    
    <div class="post">
        <div class="post-title">
            <p class="footnote">
                


    <time datetime="2021-04-22T00:00:00Z" class="post-list timeago">22.04.2021</time>






    |



    tags:[ <a href="https://vaclavblazej.github.io/tags/image">image</a> <a href="https://vaclavblazej.github.io/tags/editor">editor</a> ]






            </p>
            <h1>Imagemagick examples</h1>

            

        </div>
        <div class="post-content">
            <p>The imagemagick&rsquo;s magick (convert) program provides a great command line tool for editing images.
Doing a simple bulk edition can be frustrating as there are many unuseful resources for this program.
I made this page to keep examples of most useful commands I needed, found, and used.
It is written in a way so that when read sequentially you should get a reasonable idea how to use this tool.</p>
<div class="expandbox">
<div class="expand-container hidden" id="bash-box">
<button class="expand-title" id="bash-control">➤ <b>Running bulk commands</b></button>
<div class="expand-content">
<p>To be able to do bulk edition a basic <code>bash</code> knowledge is expected.
A command similar to the following one is expected to be used with the commands.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">for</span> i in folder/*.png; <span style="color:#000;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>    convert <span style="color:#008080">$i</span> <span style="color:#d14">&#34;</span><span style="color:#000;font-weight:bold">$(</span>dirname <span style="color:#d14">&#34;</span><span style="color:#008080">$i</span><span style="color:#d14">&#34;</span><span style="color:#000;font-weight:bold">)</span><span style="color:#d14">/</span><span style="color:#000;font-weight:bold">$(</span>basename <span style="color:#d14">&#34;</span><span style="color:#008080">$i</span><span style="color:#d14">&#34;</span> .png<span style="color:#000;font-weight:bold">)</span><span style="color:#d14">.bmp&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">done</span>
</span></span></code></pre></div></div>
</div>
</div>
<script>setupToggleDiv("bash" + "-box", "bash" + "-control")</script>
<div class="expandbox">
<div class="expand-container hidden" id="setup-box">
<button class="expand-title" id="setup-control">➤ <b>Installing and running imagemagick</b></button>
<div class="expand-content">
<p>Installation is made by installing <code>imagemagick</code> package (<code>sudo apt install imagemagick</code> for ubuntu).
Invoking <code>convert logo: logo.gif</code> then creates a file <code>logo.gif</code> with the package&rsquo;s logo, confirming it is installed correctly.
However, invoking the program is different on different systems.
I saw <code>magick</code>, but my ubuntu uses <code>convert</code> &ndash; not sure why that is, but just use your variant.</p>
</div>
</div>
</div>
<script>setupToggleDiv("setup" + "-box", "setup" + "-control")</script>
<p>Throughout this post I will use a quite complex picture of a <a href="https://ageofempires.fandom.com/wiki/Knight_%28Age_of_Empires_II%29"target="_blank">knight from AoE II<span style="white-space: nowrap;">&thinsp;↗</span></a>.</p>
<p><img src="img/knight.webp" alt="original picture"></p>
<p>Each example lists the source pistures first and result pictures next for comparison.</p>
<h2 id="converting-between-formats">Converting between formats</h2>
<p>Converting is very simple.
Note that the first argument is source and the last argument is the result.</p>
<pre tabindex="0"><code>convert knight.webp knight.png
convert knight.webp knight.bmp
convert knight.webp knight.jpg
</code></pre><p><img src="img/knight.webp" alt="original for comparison">
<img src="img/knight.png" alt="resulting knight.png">
<img src="img/knight.bmp" alt="resulting knight.bmp">
<img src="img/knight.jpg" alt="resulting knight.jpg"></p>
<h2 id="resizing">Resizing</h2>
<p>Exact stretching
Match one dimension and scale the picture
Scale by the given percentage</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>convert knight.png -resize 120x80<span style="color:#d14">\!</span> knight_wide.png
</span></span><span style="display:flex;"><span>convert knight.png -resize x80 knight_small.png
</span></span><span style="display:flex;"><span>convert knight.png -resize 40% knight_smaller.png
</span></span></code></pre></div><p><img src="img/knight.png" alt="original for comparison">
<img src="img/knight_wide.png" alt="wide">
<img src="img/knight_small_small.png" alt="small">
<img src="img/knight_small_smaller.png" alt="even smaller"></p>
<h2 id="cropping">Cropping</h2>
<p>The coordinates for cropping are given as <code>&lt;width&gt;x&lt;height&gt;+&lt;x offset&gt;+&lt;y offset&gt;</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>convert knight.png -crop 120x60+0+20 knight_cropped.png
</span></span><span style="display:flex;"><span>convert knight.jpg -fill none -stroke white -draw <span style="color:#d14">&#34;rectangle 0,20 120,80&#34;</span> knight_crop_outline.png 
</span></span></code></pre></div><p><img src="img/knight.png" alt="original for comparison">
<img src="img/knight_cropped.png" alt="cropped">
<img src="img/knight_crop_outline.png" alt="crop location"></p>
<h2 id="mirroring-flipping-and-rotating">Mirroring (Flipping) and rotating</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>convert knight.png -flip knight_flip.png
</span></span><span style="display:flex;"><span>convert knight.png -flop knight_flop.png
</span></span><span style="display:flex;"><span>convert knight.png -rotate <span style="color:#099">90</span> knight_rotate_90.png
</span></span><span style="display:flex;"><span>convert knight.png -background none -rotate <span style="color:#099">25</span> knight_rotate_25.png
</span></span></code></pre></div><p><img src="img/knight.png" alt="original for comparison">
<img src="img/knight_flip.png" alt="flip">
<img src="img/knight_flop.png" alt="flop">
<img src="img/knight_rotate_90.png" alt="rotate 90">
<img src="img/knight_rotate_25.png" alt="rotate 25"></p>
<h2 id="distortion">Distortion</h2>
<h3 id="blur">Blur</h3>
<p><a href="https://legacy.imagemagick.org/Usage/blur/"target="_blank">Blur<span style="white-space: nowrap;">&thinsp;↗</span></a> with <code>&lt;radius&gt;x&lt;sigma&gt;</code>, 0 radius is unlimited.
Small radius restricts the blur to some radius; leads to artifacts.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>convert knight.png -blur 0x1 knight_blur_0_1.png
</span></span><span style="display:flex;"><span>convert knight.png -blur 0x10 knight_blur_0_10.png
</span></span><span style="display:flex;"><span>convert knight.png -blur 2x10 knight_blur_2_10.png
</span></span></code></pre></div><p><img src="img/knight.png" alt="original for comparison">
<img src="img/knight_blur_0_1.png" alt="blur 0 1">
<img src="img/knight_blur_0_10.png" alt="blur 0 10">
<img src="img/knight_blur_2_10.png" alt="blur 2 10"></p>
<h3 id="sharpen">Sharpen</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>convert knight_blur_0_1.png -sharpen 0x1 knight_sharpen_0_1.png
</span></span><span style="display:flex;"><span>convert knight_blur_0_3.png -sharpen 0x3 knight_sharpen_0_3.png
</span></span></code></pre></div><p><img src="img/knight_blur_0_1.png" alt="blur 0 1">
<img src="img/knight_sharpen_0_1.png" alt="sharpen 0 1">
<img src="img/knight_sharpen_0_3.png" alt="sharpen 0 3"></p>
<h2 id="recoloring">Recoloring</h2>
<p>Note that the colors can be written in formats: <code>blue</code>, <code>#0000ff</code>.</p>
<h3 id="recolor-black-white-to-green-gold">Recolor black-white to green-gold</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>convert knight.png +level-colors green,gold knight_green_gold.png
</span></span></code></pre></div><p><img src="img/knight.png" alt="original for comparison">
<img src="img/knight_green_gold.png" alt="mapping to green and gold"></p>
<h3 id="splitswapcombine-color-channels">Split/Swap/Combine color channels</h3>
<p>Splitting via <code>-separate</code> creates a picture for each channel in the buffer.
Hence, the following command generates three pictures named <code>knight_channels-0.png</code>, <code>knight_channels-1.png</code>, and <code>knight_channels-2.png</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>convert knight.png -channel RGB -separate knight_channels.png
</span></span></code></pre></div><p><img src="img/knight.png" alt="original for comparison">
<img src="img/knight_channels-0.png" alt="red">
<img src="img/knight_channels-1.png" alt="green">
<img src="img/knight_channels-2.png" alt="blue"></p>
<div class="expandbox">
<div class="expand-container hidden" id="channels-box">
<button class="expand-title" id="channels-control">➤ <b>Working with and combining the channels back into the original picture</b></button>
<div class="expand-content">
<p>The separated pictures can be manipulated with (e.g. <code>-swap 1,2</code>) and recombined.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>convert knight.png -channel RGB -separate -swap 1,2 -combine knight_swapped_channels.png
</span></span></code></pre></div><p><img src="img/knight.png" alt="original for comparison">
<img src="img/knight_swapped_channels.png" alt="channels swapped"></p>
<p>Having the channels as input, we can <code>-combine</code> into a single picture</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>convert -channel RGB knight_channels-0.png knight_channels-1.png knight_channels-2.png -combine knight_combined_channels.png
</span></span></code></pre></div><p><img src="img/knight_channels-0.png" alt="red">
<img src="img/knight_channels-1.png" alt="green">
<img src="img/knight_channels-2.png" alt="blue">
<img src="img/knight_combined_channels.png" alt="combined channels"></p>
</div>
</div>
</div>
<script>setupToggleDiv("channels" + "-box", "channels" + "-control")</script>
<h3 id="ramp-up-contrast">Ramp up contrast</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>convert knight.png -contrast knight_contrast.png
</span></span><span style="display:flex;"><span>convert knight.png -sigmoidal-contrast 10,50% knight_contrast_sig.png
</span></span></code></pre></div><p><img src="img/knight.png" alt="original for comparison">
<img src="img/knight_contrast.png" alt="contrast">
<img src="img/knight_contrast_sig.png" alt="sigmoidal contrast"></p>
<div class="expandbox">
<div class="expand-container hidden" id="contrast-box">
<button class="expand-title" id="contrast-control">➤ <b>More examples on contrast</b></button>
<div class="expand-content">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>convert knight.png -sigmoidal-contrast 4,20% knight_contrast_4_20.png
</span></span><span style="display:flex;"><span>convert knight.png -sigmoidal-contrast 4,50% knight_contrast_4_50.png
</span></span><span style="display:flex;"><span>convert knight.png -sigmoidal-contrast 4,80% knight_contrast_4_80.png
</span></span></code></pre></div><p><img src="img/knight.png" alt="original for comparison">
<img src="img/knight_contrast_4_20.png" alt="contrast">
<img src="img/knight_contrast_4_50.png" alt="contrast">
<img src="img/knight_contrast_4_80.png" alt="contrast"></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>convert knight.png -sigmoidal-contrast 10,20% knight_contrast_10_20.png
</span></span><span style="display:flex;"><span>convert knight.png -sigmoidal-contrast 10,50% knight_contrast_10_50.png
</span></span><span style="display:flex;"><span>convert knight.png -sigmoidal-contrast 10,80% knight_contrast_10_80.png
</span></span></code></pre></div><p><img src="img/knight.png" alt="original for comparison">
<img src="img/knight_contrast_10_20.png" alt="contrast">
<img src="img/knight_contrast_10_50.png" alt="contrast">
<img src="img/knight_contrast_10_80.png" alt="contrast"></p>
</div>
</div>
</div>
<script>setupToggleDiv("contrast" + "-box", "contrast" + "-control")</script>
<h2 id="alpha">Alpha</h2>
<h3 id="create-transparent-background-in-a-picture-with-monotone-colored-background">Create transparent background in a picture with monotone colored background</h3>
<p><a href="http://www.imagemagick.org/script/command-line-options.php#transparent"target="_blank">transparent<span style="white-space: nowrap;">&thinsp;↗</span></a></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>convert knight.png -fuzz 7% -fill none -draw <span style="color:#d14">&#34;matte 0,0 floodfill&#34;</span> knight_background_alpha.png
</span></span></code></pre></div><p><img src="img/knight.png" alt="original for comparison">
<img src="img/knight_background_alpha.png" alt="background into alpha"></p>
<div class="expandbox">
<div class="expand-container hidden" id="remove_background-box">
<button class="expand-title" id="remove_background-control">➤ <b>Experimenting with removing background -- setting fuzz and floodfill</b></button>
<div class="expand-content">
<p>Setting the fuzz is image-dependent.
Sometimes (such as for this picture), it is not good enough.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>convert knight.png -transparent black knight_background_alpha_0.png
</span></span><span style="display:flex;"><span>convert knight.png -fuzz 2% -transparent black knight_background_alpha_2.png
</span></span><span style="display:flex;"><span>convert knight.png -fuzz 5% -transparent black knight_background_alpha_5.png
</span></span><span style="display:flex;"><span>convert knight.png -fuzz 8% -transparent black knight_background_alpha_8.png
</span></span></code></pre></div><p><img src="img/knight.png" alt="original for comparison">
<img src="img/knight_background_alpha_0.png" alt="background into alpha with fuzz 0">
<img src="img/knight_background_alpha_2.png" alt="background into alpha with fuzz 2">
<img src="img/knight_background_alpha_5.png" alt="background into alpha with fuzz 5">
<img src="img/knight_background_alpha_8.png" alt="background into alpha with fuzz 8"></p>
<p>If we want to keep the removed area continuous, that mark the position (<code>0,0</code> here) where the background is located.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>convert knight.png -fuzz 0% -fill none -draw <span style="color:#d14">&#34;matte 0,0 floodfill&#34;</span> knight_background_alpha_fill_0.png
</span></span><span style="display:flex;"><span>convert knight.png -fuzz 2% -fill none -draw <span style="color:#d14">&#34;matte 0,0 floodfill&#34;</span> knight_background_alpha_fill_2.png
</span></span><span style="display:flex;"><span>convert knight.png -fuzz 3% -fill none -draw <span style="color:#d14">&#34;matte 0,0 floodfill&#34;</span> knight_background_alpha_fill_3.png
</span></span><span style="display:flex;"><span>convert knight.png -fuzz 4% -fill none -draw <span style="color:#d14">&#34;matte 0,0 floodfill&#34;</span> knight_background_alpha_fill_4.png
</span></span><span style="display:flex;"><span>convert knight.png -fuzz 8% -fill none -draw <span style="color:#d14">&#34;matte 0,0 floodfill&#34;</span> knight_background_alpha_fill_8.png
</span></span><span style="display:flex;"><span>convert knight.png -fuzz 20% -fill none -draw <span style="color:#d14">&#34;matte 0,0 floodfill&#34;</span> knight_background_alpha_fill_20.png
</span></span></code></pre></div><p><img src="img/knight_background_alpha_fill_0.png" alt="background into alpha fill with fuzz 0">
<img src="img/knight_background_alpha_fill_2.png" alt="background into alpha fill with fuzz 2">
<img src="img/knight_background_alpha_fill_3.png" alt="background into alpha fill with fuzz 3">
<img src="img/knight_background_alpha_fill_4.png" alt="background into alpha fill with fuzz 4">
<img src="img/knight_background_alpha_fill_8.png" alt="background into alpha fill with fuzz 8">
<img src="img/knight_background_alpha_fill_20.png" alt="background into alpha fill with fuzz 20"></p>
</div>
</div>
</div>
<script>setupToggleDiv("remove_background" + "-box", "remove_background" + "-control")</script>
<h2 id="composition">Composition</h2>
<p>todo</p>
<h2 id="useful-resources">Useful resources</h2>
<ul>
<li><a href="http://www.fmwconcepts.com/imagemagick/tidbits/image.php"target="_blank">http://www.fmwconcepts.com/imagemagick/tidbits/image.php<span style="white-space: nowrap;">&thinsp;↗</span></a></li>
</ul>

        </div>
    </div>
</div>

<div class="footer">
    <ul class="pad-content">

        <li>
            © Václav Blažej
            
                2021
            
        </li>
        

        

        
    </ul>
    <ul title="Last update of the website" class="pull-right pad">6. September 2024</ul>
</div>

<script type="text/javascript">
    $("#toggle-btn").click(function(){
        $("#toggle-content").toggle();
        if($(this).html() === "☰") {
            $(this).html("X")
        } else {
            $(this).html("☰")
        }
    });
    $(window).resize(function(){
        if(window.innerWidth > 768) {
            $(".desktop").removeAttr("style");
        }
    });
</script>
</body>
</html>

